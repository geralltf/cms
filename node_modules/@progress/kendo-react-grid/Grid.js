/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const Ie=require("react"),o=require("prop-types"),p=require("@progress/kendo-react-common"),d=require("@progress/kendo-react-data-tools"),Ee=require("./cells/GridSelectionCell.js"),xe=require("./cells/GridHierarchyCell.js"),_e=require("./cells/GridEditCell.js"),Te=require("./header/Header.js"),ze=require("./header/HeaderRow.js"),De=require("./header/FilterRow.js"),He=require("./header/GroupPanel.js"),Ne=require("./footer/Footer.js"),ae=require("@progress/kendo-react-intl"),G=require("./messages/index.js"),Me=require("./VirtualScroll.js"),se=require("./VirtualScrollFixed.js"),Fe=require("./drag/ColumnResize.js"),Le=require("./drag/CommonDragLogic.js"),v=require("./utils/index.js"),Oe=require("./cells/GridCell.js"),ie=require("./cells/GridGroupCell.js"),Ae=require("./rows/GridRow.js"),Ge=require("./header/GridHeaderSelectionCell.js"),Ke=require("./GridNoRecords.js"),oe=require("./filterCommon.js"),Pe=require("./footer/FooterRow.js"),qe=require("./paging/GridPagerSettings.js"),re=require("./package-metadata.js"),Ve=require("./cells/GridDetailCell.js"),Ue=require("./cells/GridDetailHierarchyCell.js"),We=require("./constants/index.js");function Be(z){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(z){for(const h in z)if(h!=="default"){const u=Object.getOwnPropertyDescriptor(z,h);Object.defineProperty(r,h,u.get?u:{enumerable:!0,get:()=>z[h]})}}return r.default=z,Object.freeze(r)}const a=Be(Ie),T=class T extends a.Component{constructor(r){super(r),this._columns=[],this._columnsMap=[[]],this._columnsMutations=0,this._resized=!1,this._focusFirst=!1,this._shouldUpdateLeftRight=!0,this.contextStateRef={current:void 0},this.navigationStateRef={current:void 0},this._data=[],this._slicedData=void 0,this.wrapperScrollTop=0,this.showLicenseWatermark=!1,this.headerRef=a.createRef(),this.headerElementRef=a.createRef(),this._element=null,this.tableElement=null,this.containerRef=a.createRef(),this.tableBodyRef=a.createRef(),this._footer=null,this.forceUpdateTimeout=void 0,this.isRtl=!1,this.headTable=null,this.observer=null,this.handleIntersection=e=>{const t={rowIndex:this.rowIndex};e.forEach(s=>{s.isIntersecting||this.setCurrentOnTop(t)})},this.setCurrentOnTop=e=>{if(!this.vs.container||this.props.scrollable==="none")return;this.observer&&this.observer.disconnect();const{rowIndex:t}=e;if(this.props.scrollable==="virtual")this.vs.askedSkip=t,this.vs.container.scroll(0,Math.round(this.vs.askedSkip/this.vs.total*this.vs.container.scrollHeight));else if(this.element){const s=t<1?this.element.querySelector("tbody > tr:nth-child(1)"):this.element.querySelector(`tbody > tr:nth-child(${t+1})`);s&&this.containerRef.current&&(this.containerRef.current.scrollTop=s.offsetTop)}},this.scrollIntoView=e=>{if(!this.vs.container||this.props.scrollable==="none")return;this.rowIndex=e.rowIndex;const{rowIndex:t}=e,s=this.element;if(this.observer&&s){this.observer.disconnect();const l=s.querySelector(`[absolute-row-index="${t}"]`);l?this.observer.observe(l):this.setCurrentOnTop(e)}},this.fitColumns=e=>{this.columnResize.dblClickHandler(null,e)},this.getColumnsEssentialProps=e=>JSON.stringify(e.map(t=>({id:t.id,field:t.field,title:t.title,children:t.children}))),this.checkMatchMediaColumnsDifferece=()=>{const e=this.childrenToArray(this.props.children),t=d.tableKeyboardNavigationTools.getIdPrefix(this.navigationStateRef),s=this.filterHiddenColumns(e);return this.getColumnsEssentialProps(this.readColumns(s,t,this._columnsMutations))===this.getColumnsEssentialProps(this._columns)},this.onContextMenu=(e,t,s)=>{if(this.props.onContextMenu){const l={target:this,syntheticEvent:e,nativeEvent:e.nativeEvent,dataItem:t,field:s};this.props.onContextMenu.call(void 0,l)}},this.getVirtualScroll=e=>{const{rowHeight:t,detailRowHeight:s,detail:l,expandField:c,groupable:n}=e,g=this.isAllData(),C=t!==void 0&&t>0,w=s!==void 0&&s>0,x=n===!0||typeof n=="object"&&n.enabled!==!1;return!C||x&&!g||!!(l&&c)&&(!w||!g)?Me.VirtualScroll:se.VirtualScrollFixed},this.isAllData=()=>{const{data:e,total:t}=this.props;return Array.isArray(e)?e.length===t:e?t===e.total:!1},this.initializeVirtualization=(e,t)=>{if(this.reInitVirtualization(this.props.scrollable==="virtual",this.props.total,this.props.filter,this.props.group,this.props.sort,t||this.props.rowHeight===void 0||this.props.rowHeight===0),this.vs.fixedScroll=this.props.fixedScroll||!1,this.vs.PageChange=this.pageChange,this.vs.realSkip=this.props.skip||0,this.vs.pageSize=(this.props.take!==void 0?this.props.take:this.props.pageSize)||0,this.vs.scrollableVirtual=this.props.scrollable==="virtual",this.vs.total=e,this.vs.propsSkip=(this.props.skip||0)+(this.props.scrollable==="virtual"?this.vs.topCacheCount+(this.vs.attendedSkip-(this.props.skip||0)):0),this.props.rowHeight!==void 0&&this.props.rowHeight>0&&!t){const s=this.props.rowHeight*e;this.vs.containerHeight=v.firefox?Math.min(v.firefoxMaxHeight,s):s}else this.vs.containerHeight=1533915;if(this.vs.containerRef=this.containerRef,this.vs.tableBodyRef=this.tableBodyRef,this.vs.table=this.tableElement,this._slicedData=void 0,this.vs instanceof se.VirtualScrollFixed){const{rowHeight:s=0,detail:l,expandField:c}=this.props;let{detailRowHeight:n=0}=this.props;n=l&&c?n:s,this.isAllData()?(this.vs.total=this._data.length,this._slicedData=this._data.slice(this.vs.realSkip,this.vs.realSkip+this.vs.pageSize),this.vs.rowHeightService=this.rowHeightService(this.vs,this._data.length,s,n,this._data)):this.vs.rowHeightService=new p.RowHeightService(e,s,n);const g=this.vs.rowHeightService.totalHeight();this.vs.containerHeight=v.firefox?Math.min(v.firefoxMaxHeight,g):g}},this.scrollHandler=e=>{if(e.target!==e.currentTarget)return;clearTimeout(this.forceUpdateTimeout),this.vs.table=this.tableElement;const t=e.currentTarget.scrollLeft,s=e.currentTarget.scrollTop;this.props.columnVirtualization&&(!this.vs.scrollableVirtual||s===this.wrapperScrollTop)&&(this.forceUpdateTimeout=window.setTimeout(()=>{this.forceUpdate()},0)),this._header&&this._header.setScrollLeft(t),this._footer&&this._footer.setScrollLeft(t),this.vs&&s!==this.wrapperScrollTop&&this.vs.scrollHandler(e),p.dispatchEvent(this.props.onScroll,e,this,void 0),this.wrapperScrollTop=s},this.onKeyDown=e=>{if(d.tableKeyboardNavigation.onKeyDown(e,{contextStateRef:this.contextStateRef,navigationStateRef:this.navigationStateRef,onNavigationAction:this.onNavigationAction}),this.props.onKeyDown){const{mode:t,cell:s}=d.getSelectionOptions(this.props.selectable),l={dataItems:this.getLeafDataItems(),mode:t,cell:s,componentId:this._gridId,selectedField:this.props.selectedField,...this.getArguments(e)};this.props.onKeyDown.call(void 0,l)}},this.onFocus=e=>{d.tableKeyboardNavigation.onFocus(e,{contextStateRef:this.contextStateRef})},this.onNavigationAction=e=>{if(e.action==="moveToNextPage"&&this.moveToNextPage(e.event),e.action==="moveToPrevPage"&&this.moveToPrevPage(e.event),e.focusElement&&e.action==="reorderToRight"){const t=parseInt(e.focusElement.ariaColIndex,10)-1;t<this._columns.length-1&&this.columnReorder(t,t+1,e.event)}if(e.focusElement&&e.action==="reorderToLeft"){const t=parseInt(e.focusElement.ariaColIndex,10)-1;t>0&&this.columnReorder(t,t-1,e.event)}if(this.props.onNavigationAction){const t={focusElement:e.focusElement,...this.getArguments(e.event)};this.props.onNavigationAction.call(void 0,t)}},this.rowClick=(e,t)=>{this.props.onRowClick&&e.target.nodeName==="TD"&&this.props.onRowClick.call(void 0,{dataItem:t.dataItem,...this.getArguments(e)})},this.rowDblClick=(e,t)=>{this.props.onRowDoubleClick&&e.target.nodeName==="TD"&&this.props.onRowDoubleClick.call(void 0,{dataItem:t.dataItem,...this.getArguments(e)})},this.itemChange=e=>{const t=this.props.onItemChange;if(e.field===this.props.expandField||this.props.group&&e.field===void 0){const s=this.props.onExpandChange;s&&s.call(void 0,{...this.getArguments(e.syntheticEvent),dataItem:e.dataItem,dataIndex:e.dataIndex,value:e.value});return}t&&t.call(void 0,{...this.getArguments(e.syntheticEvent),dataItem:e.dataItem,field:e.field,value:e.value})},this.onHeaderSelectionChange=e=>{this.props.onHeaderSelectionChange&&this.props.onHeaderSelectionChange.call(void 0,{field:e.field,nativeEvent:e.syntheticEvent&&e.syntheticEvent.nativeEvent,syntheticEvent:e.syntheticEvent,target:this,dataItems:this.getLeafDataItems(),selectedField:this.props.selectedField})},this.selectionRelease=e=>{if(this.props.onSelectionChange){const t=this.getSlicedLeafDataItems()[e.startRowIndex],s=this.getSlicedLeafDataItems()[e.endRowIndex],l={syntheticEvent:void 0,target:this,selectedField:this.props.selectedField||"",componentId:this._gridId,dataItems:this.getLeafDataItems(),dataItem:null,startDataItem:t,endDataItem:s,...e};this.props.onSelectionChange.call(void 0,l)}},this.pageChange=(e,t,s)=>{this.raiseDataEvent(this.props.onPageChange,{page:e},{skip:e.skip,take:e.take},t,s)},this.getTotal=()=>{let e=this.props.total||0;return Array.isArray(this.props.data)?e=e||this.props.data.length:this.props.data&&(e=e||this.props.data.total),e},this.moveToNextPage=e=>{const t=this.props.take||0,s=(this.props.skip||0)+t,l=this.getTotal();s<l&&this.pageChange({skip:s,take:t},e)},this.moveToPrevPage=e=>{const t=this.props.take||0,s=(this.props.skip||0)-t;s>=0&&this.pageChange({skip:s,take:t},e)},this.pagerPageChange=e=>{this.pageChange({skip:e.skip,take:e.take},e.syntheticEvent,e.targetEvent)},this.sortChange=(e,t)=>{this.raiseDataEvent(this.props.onSortChange,{sort:e},{sort:e,...this.props.scrollable==="virtual"?{skip:0}:{}},t)},this.filterChange=(e,t)=>{this.raiseDataEvent(this.props.onFilterChange,{filter:e},{filter:e||void 0,skip:0},t)},this.groupChange=(e,t)=>{const s=t.nativeEvent?t:{nativeEvent:t.nativeEvent||t.originalEvent};e.length===0&&this.props.navigatable&&(this._focusFirst=!0),this._columnsMutations++,this.raiseDataEvent(this.props.onGroupChange,{group:e},{group:e,skip:0},s)},this.onClipboard=(e,t)=>{if(this.props.onClipboard){if(!this.inActiveElement()||!e)return;this.props.onClipboard.call(void 0,{type:e,nativeEvent:t,columns:this._columns,dataItemKey:this.props.dataItemKey||"",...typeof this.props.clipboard!="boolean"?this.props.clipboard:{}})}},this.inActiveElement=()=>{var c,n,g;if(!p.canUseDOM)return!1;const e=p.getActiveElement(this.document),t=e?e.matches(".k-table-td")?e:(c=this.document)==null?void 0:c.body:(n=this.document)==null?void 0:n.body,s=t.closest(".k-grid-container"),l=t&&((g=this._element)==null?void 0:g.contains(t));return!!(t&&l&&s)},this.onResize=(e,t,s,l,c,n)=>{this.resetTableWidth(),this._shouldUpdateLeftRight=!0,this._resized=!0,this._columnsMutations++,this.props.onColumnResize&&this.props.onColumnResize.call(void 0,{columns:this.columns,nativeEvent:l,targetColumnId:n,index:e,newWidth:t,oldWidth:s,end:c,target:this})},this.reInitVirtualization=p.memoizeOne((e,t,s,l,c,n)=>{this.vs.reset();const g=this.getVirtualScroll(this.props);this.vs=new g(n)}),this.flatData=p.memoizeOne((e,t,s,l,c,n,g)=>{const C=[],w=v.flatData(C,e,t,{index:s},l!==void 0,c);return{flattedData:C,resolvedGroupsCount:w}}),this.rowHeightService=p.memoizeOne((e,t,s,l,c)=>new p.RowHeightService(t,s,l,c)),this.childrenToArray=p.memoizeOne(e=>a.Children.toArray(e)),this.readColumns=p.memoizeOne((e,t,s)=>{const l=e.filter(c=>c&&c.type&&c.type.displayName==="KendoReactGridColumn");return v.readColumns(l,this.columns,{prevId:0,idPrefix:t})}),this.mapColumns=p.memoizeOne((e,t)=>d.mapColumns(e,!0)),this.filterHiddenColumns=e=>{const t=s=>{const l=s;return{...l,props:{...l.props,children:l.props.children&&l.props.children.length>0?this.filterHiddenColumns(l.props.children):l.props.children}}};return[...e].filter(s=>a.isValidElement(s)&&!s.props.hidden).filter(s=>p.canUseDOM&&s&&a.isValidElement(s)&&s.props.media?window.matchMedia(s.props.media).matches:s).map(s=>t(s))},this.configureColumns=p.memoizeOne((e,t,s)=>{this.props.selectedField&&e.filter(n=>n.field===this.props.selectedField).forEach(n=>{n.width=n.width||"50px",n.cell=n.cell||Ee.GridSelectionCell,n.headerCell=n.headerCell||Ge.GridHeaderSelectionCell});const l={id:"",resizable:!0,width:"32px",title:" ",declarationIndex:-1,orderIndex:-1,children:[],parentIndex:-1,depth:0,colSpan:0,rowSpan:0,left:0,right:0,index:0,rightBorder:!1,ariaColumnIndex:0,isAccessible:!0};let c=0;this.props.expandField&&this.props.onExpandChange&&this.props.detail&&(e.unshift({...l,cell:xe.GridHierarchyCell,field:this.props.expandField,headerClassName:"k-hierarchy-cell k-header"}),c++);for(let n=0;n<t;n++)e.unshift({...l,isAccessible:!1,cell:ie.GridGroupCell,field:"value",locked:this.props.lockGroups}),c++;e.slice(c).forEach(n=>n.parentIndex>=0&&(n.parentIndex+=c))}),this.getHeaderRow=p.memoizeOne((e,t,s,l,c,n,g,C,w,x,D,S,L)=>a.createElement(ze.HeaderRow,{cells:this.props.cells,sort:e,sortable:t,sortChange:this.sortChange,group:s||[],groupable:l,groupChange:this.groupChange,filter:c,filterable:n,filterOperators:g,filterChange:this.filterChange,columnMenu:w,columnMenuIcon:x,selectionChange:this.onHeaderSelectionChange,columns:D,columnResize:this.columnResize,pressHandler:this.dragLogic.pressHandler,dragHandler:this.dragLogic.dragHandler,releaseHandler:this.dragLogic.releaseHandler,columnsMap:S,cellRender:C,isRtl:L,dragClue:this.dragLogic.dragClueRef,headerRef:this.headerElementRef,containerRef:this.containerRef,navigatable:this.props.navigatable,columnGroupChange:this.columnGroupChange})),this.resolveTitle=e=>{const t=this._columns.find(l=>l.field===e),s=t&&(t.title||t.field);return s===void 0?e:s},this.getLeafDataItems=()=>this._data.filter(e=>e.rowType==="data").map(e=>e.dataItem),this.getSlicedLeafDataItems=()=>(this._slicedData||this._data).filter(e=>e.rowType==="data").map(e=>e.dataItem),p.validatePackage(re.packageMetadata),this.showLicenseWatermark=p.shouldShowValidationUI(re.packageMetadata);const h=this.props.groupable===!0||typeof this.props.groupable=="object"&&this.props.groupable.enabled!==!1,u=this.getVirtualScroll(r);this.vs=new u(h||r.rowHeight===void 0||r.rowHeight===0),this.dragLogic=new Le.CommonDragLogic(this.columnReorder.bind(this),this.groupReorder.bind(this),this.columnToGroup.bind(this)),this.columnGroupChange=this.columnGroupChange.bind(this),this.columnResize=new Fe.ColumnResize(this.onResize),this.props.clipboard&&(this.clipboardService=new d.ClipboardService(this.onClipboard)),d.tableKeyboardNavigation.onConstructor({navigatable:!!r.navigatable,contextStateRef:this.contextStateRef,navigationStateRef:this.navigationStateRef,idPrefix:this._gridId})}get columns(){const r=this._columns.filter(h=>h.declarationIndex>=0&&h.parentIndex===-1);return v.sanitizeColumns(r)}get element(){return this._element}get document(){if(p.canUseDOM)return this.element&&this.element.ownerDocument||document}get _header(){return this.headerRef.current}get _gridId(){return this.props.id+"-role-element-id"}componentDidMount(){var u;this.props.columnVirtualization&&!navigator.userAgent.match(We.SAFARI_REGEX)&&(this.headTable&&(this.headTable.style.display="block"),this.tableElement&&(this.tableElement.style.display="block")),this.resetTableWidth(),p.setScrollbarWidth();const r=d.isRtl(this.element);this.isRtl=r,d.tableKeyboardNavigation.onComponentDidMount({scope:this.element||void 0,contextStateRef:this.contextStateRef,navigationStateRef:this.navigationStateRef}),this.isRtl&&this.forceUpdate();const h={rootMargin:"0px",threshold:.9};this.clipboardService&&this.clipboardService.addEventListeners(this.document),this.observer=p.canUseDOM&&window.IntersectionObserver&&new window.IntersectionObserver(this.handleIntersection,h)||null,this.resizeObserver=p.canUseDOM&&window.ResizeObserver&&new window.ResizeObserver(this.calculateMedia.bind(this)),(u=this.document)!=null&&u.body&&this.resizeObserver&&this.resizeObserver.observe(this.document.body)}getSnapshotBeforeUpdate(){return d.tableKeyboardNavigation.onGetSnapshotBeforeUpdate({document:this.document,contextStateRef:this.contextStateRef,navigationStateRef:this.navigationStateRef}),null}componentDidUpdate(){this.resetTableWidth(),p.setScrollbarWidth(),this.vs.tableTransform&&this.vs.table&&(this.vs.table.style.transform=this.vs.tableTransform,this.vs.tableTransform=""),d.tableKeyboardNavigation.onComponentDidUpdate({scope:this.element||void 0,contextStateRef:this.contextStateRef,navigationStateRef:this.navigationStateRef,focusFirst:this._focusFirst}),this._focusFirst=!1}componentWillUnmount(){var r;clearTimeout(this.forceUpdateTimeout),this.clipboardService&&this.clipboardService.removeEventListeners(this.document),(r=this.document)!=null&&r.body&&this.resizeObserver&&this.resizeObserver.disconnect()}render(){var ee;let r=this.props.total||0;const h=d.tableKeyboardNavigationTools.getIdPrefix(this.navigationStateRef),u=ae.provideLocalizationService(this);let e=[];Array.isArray(this.props.data)?(e=this.props.data,r=r||this.props.data.length):this.props.data&&(e=this.props.data.data,r=r||this.props.data.total);const t=typeof this.props.groupable=="object"&&this.props.groupable.footer||"none",s=this.props.scrollable==="virtual",{resolvedGroupsCount:l,flattedData:c}=this.flatData(e,t,this.props.skip||0,this.props.group,this.props.expandField,this.props.filter,this.props.sort);this._data=c;const n=this.props.groupable===!0||typeof this.props.groupable=="object"&&this.props.groupable.enabled!==!1;this.columnResize.resizable=this.props.resizable||!1,this.dragLogic.reorderable=this.props.reorderable||!1,this.dragLogic.groupable=n;const g=this.props.selectable&&this.props.selectable.drag?"none":void 0;this.initializeVirtualization(r,n);const C=this.childrenToArray(this.props.children);this.initColumns(C,l);const w=C.map(i=>i&&i.type&&i.type.displayName==="KendoReactGridToolbar"?a.cloneElement(i,{...i.props,ariaControls:this._gridId}):null),x=C.filter(i=>i&&i.type&&i.type.displayName==="KendoReactGridNoRecords"),D=C.filter(i=>i&&i.type&&i.type.displayName==="KendoReactGridStatusBar"),S=this._columns.filter(i=>i.children.length===0),L=n&&a.createElement(He.GroupPanel,{group:this.props.group||[],groupChange:this.groupChange,pressHandler:this.dragLogic.pressHandler,dragHandler:this.dragLogic.dragHandler,releaseHandler:this.dragLogic.releaseHandler,refCallback:this.dragLogic.refGroupPanelDiv,resolveTitle:this.resolveTitle,ariaControls:this._gridId,onContextMenu:this.onContextMenu}),{sort:le,sortable:ne,group:he,filter:de,filterable:pe,filterOperators:ce=oe.operators,headerCellRender:ue,columnMenu:ge,columnMenuIcon:fe}=this.props,U=a.createElement(Te.Header,{size:this.props.size,columnResize:this.columnResize,staticHeaders:this.props.scrollable!=="none",scrollableDataElement:()=>this.vs.container,draggable:this.props.reorderable||n,ref:this.headerRef,elemRef:this.headerElementRef,headerRow:this.getHeaderRow(le,ne,he,n,de,pe,ce,ue,ge,fe,this._columns,this._columnsMap,this.isRtl),filterRow:this.props.filterable&&a.createElement(De.FilterRow,{cells:this.props.cells,size:this.props.size,columns:this._columns,filter:this.props.filter,filterOperators:this.props.filterOperators||oe.operators,filterChange:this.filterChange,sort:this.props.sort,cellRender:this.props.filterCellRender,isRtl:this.isRtl,ariaRowIndex:this._columnsMap.length+1})||void 0,cols:S.map((i,m)=>a.createElement("col",{key:m.toString(),width:v.getColumnWidth(i)}))}),me=this.vs&&this.vs.container&&this.vs.container.scrollLeft||0,be=parseFloat(((this.props.style||{}).width||"").toString()),{colSpans:ve,hiddenColumns:Ce}=d.tableColumnsVirtualization({enabled:this.props.columnVirtualization,columns:S,tableViewPortWidth:be,scrollLeft:me}),Re=(i,m,b)=>{let _=!1;const E=this.props.selectedField?v.getNestedValue(this.props.selectedField,i.dataItem):void 0;return{row:S.map((f,R)=>{if(Ce[R])return null;const N=f.id?f.id:R,M=`${f.className?f.className+" ":""}${f.locked?"k-grid-content-sticky":""}`,k=f.left!==void 0?this.isRtl?{left:f.right,right:f.left}:{left:f.left,right:f.right}:{};let I=!1;if(f.editable&&this.props.editField){const y=v.getNestedValue(this.props.editField,i.dataItem);y&&(y===!0||y===f.field)&&(_=!0,I=!0)}const V=f.cell||I&&_e.GridEditCell||Oe.GridCell,F=this.props.expandField&&this.props.detail&&f.field===this.props.expandField;return a.createElement(V,{onContextMenu:this.onContextMenu,key:N,locked:this.props.lockGroups,id:d.tableKeyboardNavigationTools.generateNavigatableId(`${m}-${String(R)}`,h,F||i.rowType==="groupHeader"||i.rowType==="groupFooter"||f.field==="value"?"nodata":"cell"),colSpan:ve[R],dataItem:i.dataItem,field:f.field,editor:f.editor,format:f.format,className:M,render:this.props.cellRender,cells:v.resolveCells(this.props.cells,f.cells),onChange:this.itemChange,selectionChange:this.props.onSelectionChange?y=>{this.selectionChange({event:y,dataItem:i.dataItem,dataIndex:b,columnIndex:R})}:void 0,columnIndex:R,columnsCount:S.length,rowType:i.rowType,level:i.level,expanded:i.expanded,dataIndex:i.dataIndex,style:k,ariaColumnIndex:f.ariaColumnIndex,isSelected:Array.isArray(E)&&E.indexOf(R)>-1})}),isInEdit:_,isSelected:typeof E=="boolean"&&E}};let W=0;if(s)for(let i=0;i<this.vs.topCacheCount+this.vs.attendedSkip-(this.props.skip||0);i++){const m=this._data.shift();if(m)this._data.push(m),W++,m.rowType==="groupHeader"&&i--;else break}const B=i=>i>=this._data.length-W;let $=this.vs.realSkip||0;const O=[];let P=!1;const q=this._columnsMap.length+(this.props.filterable?1:0)+1;let H=0;if(this._data.length){let i=-1,m=0;(this._slicedData||this._data).forEach((b,_)=>{b.rowType==="data"&&($++,i++);const E=$%2===0,f=this.props.dataItemKey&&p.getter(this.props.dataItemKey)(b.dataItem),R=_+(this.vs.realSkip||0),N=f||"ai"+R,M=N+"_1",k=Re(b,N,i);if(H=R+q+m,O.push(a.createElement(Ae.GridRow,{key:N,dataItem:b.dataItem,isAltRow:E,isInEdit:k.isInEdit,rowType:b.rowType,isHidden:B(_),onClick:I=>this.rowClick(I,b),onDoubleClick:I=>this.rowDblClick(I,b),selectedField:this.props.selectedField,rowHeight:this.props.rowHeight,render:this.props.rowRender,ariaRowIndex:H,absoluteRowIndex:R,dataIndex:this.vs.scrollableVirtual&&!this.props.groupable?R:i,isSelected:k.isSelected},k.row)),this.props.detail&&b.rowType==="data"&&b.expanded){const I=S.length-(this.props.expandField?1:0)-(this.props.group?this.props.group.length:0)||1;m++,H=R+q+m,O.push(a.createElement("tr",{key:M,className:p.classNames("k-table-row",E?"k-detail-row k-table-alt-row k-alt":"k-detail-row"),style:{visibility:B(_)?"hidden":"",height:this.props.detailRowHeight},role:"row","aria-rowindex":H},this.props.group&&this.props.group.map((V,F)=>{var te;const y=(te=k==null?void 0:k.row[F])==null?void 0:te.props.style,ke=y?this.isRtl?{left:y.right,right:y.left}:{left:y.left,right:y.right}:{};return a.createElement(ie.GridGroupCell,{id:"",dataIndex:b.dataIndex,field:V.field,dataItem:b.dataItem,key:F,style:ke,ariaColumnIndex:1+F,isSelected:!1,locked:this.props.lockGroups,isRtl:this.isRtl,cells:this.props.cells})}),this.props.expandField&&a.createElement(Ue.GridDetailHierarchyCell,{id:d.tableKeyboardNavigationTools.generateNavigatableId(`${M}-dhcell`,h)}),a.createElement(Ve.GridDetailCell,{onContextMenu:this.onContextMenu,dataItem:b.dataItem,dataIndex:b.dataIndex,colSpan:I,ariaColIndex:2+(this.props.group?this.props.group.length:0),detail:this.props.detail,id:d.tableKeyboardNavigationTools.generateNavigatableId(`${M}-dcell`,h)})))}})}else P=!0;const ye=()=>{const i=this._header;return i&&i.table&&i.table.clientWidth},j=()=>a.createElement("div",{key:"no-records",className:"k-grid-norecords","aria-rowindex":q,style:{width:ye()}},a.createElement("div",{className:"k-grid-norecords-template",[d.KEYBOARD_NAV_DATA_ID]:d.tableKeyboardNavigationTools.generateNavigatableId("no-records",h)},x.length?x:a.createElement(Ke.GridNoRecords,null))),J={size:this.props.size,onPageChange:this.pagerPageChange,total:r,dir:this.isRtl?"rtl":void 0,skip:this.vs.propsSkip||0,take:(this.props.take!==void 0?this.props.take:this.props.pageSize)||10,messagesMap:G.pagerMessagesMap,navigatable:this.props.navigatable,...qe.normalize(this.props.pageable||{})},X=this.props.pager?a.createElement(this.props.pager,{...J}):a.createElement(d.Pager,{className:"k-grid-pager",...J}),Se=i=>this.props.sort&&this.props.sort.filter(m=>m.field===i).length>0,we=(i,m)=>a.createElement("col",{key:m.toString(),width:v.getColumnWidth(i)}),Y=(ee=this.props.cells)!=null&&ee.footerCell||this._columns.some(i=>{var m;return!!(i.footerCell||(m=i.cells)!=null&&m.footerCell)})?a.createElement(Ne.Footer,{size:this.props.size,columnResize:this.columnResize,staticHeaders:this.props.scrollable!=="none",ref:i=>this._footer=i,row:a.createElement(Pe.FooterRow,{cells:this.props.cells,idPrefix:h,columns:this._columns,isRtl:this.isRtl,ariaRowIndex:H+1}),cols:S.map(we)}):null,Q=a.createElement("colgroup",{ref:i=>{this.columnResize.colGroupMain=i}},S.map((i,m)=>a.createElement("col",{key:m.toString(),className:Se(i.field)?"k-sorted":void 0,width:v.getColumnWidth(i)}))),Z=this.dragLogic.reorderable||this.dragLogic.groupable;if(this.props.scrollable==="none")return a.createElement(d.TableKeyboardNavigationContext.Provider,{value:this.contextStateRef.current},a.createElement("div",{id:this.props.id,style:this.props.style,className:p.classNames("k-grid",{"k-grid-md":!this.props.size,[`k-grid-${p.kendoThemeMaps.sizeMap[this.props.size]||this.props.size}`]:this.props.size},this.props.className),ref:i=>{this._element=i},"aria-label":this.props.ariaLabel,onKeyDown:this.onKeyDown,onFocus:this.onFocus,...d.tableKeyboardNavigationScopeAttributes},w,L,a.createElement(d.TableSelection,{selectable:this.props.selectable,onRelease:this.selectionRelease,childRef:i=>{this.tableElement=i,this.headTable=i}},a.createElement("table",{ref:i=>this.headTable=i,className:p.classNames("k-table k-grid-table",{[`k-table-${p.kendoThemeMaps.sizeMap[this.props.size]||this.props.size}`]:this.props.size}),style:{userSelect:g}},Q,U,a.createElement("tbody",{role:"rowgroup",className:"k-table-tbody",...d.tableKeyboardNavigationBodyAttributes},O),Y)),P&&j(),Z&&a.createElement(a.Fragment,null,a.createElement(d.DropClue,{ref:this.dragLogic.refDropElementClue}),a.createElement(d.DragClue,{ref:this.dragLogic.refDragElementClue}))),D,this.props.pageable&&X);let A=this.props.style||{};return s&&(A.height||(A=Object.assign({},A,{height:"450px"}))),a.createElement(d.TableKeyboardNavigationContext.Provider,{value:this.contextStateRef.current},a.createElement("div",{id:this.props.id,style:A,className:p.classNames("k-grid",{"k-grid-md":!this.props.size,[`k-grid-${p.kendoThemeMaps.sizeMap[this.props.size]||this.props.size}`]:this.props.size,"k-grid-virtual":s},this.props.className),ref:i=>{this._element=i},"aria-label":this.props.ariaLabel,onKeyDown:this.onKeyDown,onFocus:this.onFocus,...d.tableKeyboardNavigationScopeAttributes},w,L,a.createElement("div",{className:"k-grid-aria-root",role:"grid","aria-colcount":S.length,"aria-rowcount":r,id:this._gridId,"aria-label":u.toLanguageString(G.gridAriaLabel,G.messages[G.gridAriaLabel])},U,a.createElement("div",{className:"k-grid-container",role:"presentation"},a.createElement("div",{ref:this.containerRef,className:"k-grid-content k-virtual-content",onScroll:this.scrollHandler,role:"presentation"},a.createElement("div",{className:"k-grid-table-wrap",role:"presentation"},a.createElement(d.TableSelection,{selectable:this.props.selectable,onRelease:this.selectionRelease,childRef:i=>{this.tableElement=i}},a.createElement("table",{ref:i=>this.tableElement=i,className:p.classNames("k-table k-grid-table",{"k-table-md":!this.props.size,[`k-table-${p.kendoThemeMaps.sizeMap[this.props.size]||this.props.size}`]:this.props.size}),role:"presentation",style:{userSelect:g}},Q,a.createElement("tbody",{className:"k-table-tbody",ref:this.tableBodyRef,role:"rowgroup",...d.tableKeyboardNavigationBodyAttributes},O))),P&&j()),s&&a.createElement("div",{className:"k-height-container",role:"presentation"},a.createElement("div",{style:s?{height:this.vs.containerHeight+"px"}:{}})))),Y,Z&&a.createElement(a.Fragment,null,a.createElement(d.DropClue,{ref:this.dragLogic.refDropElementClue}),a.createElement(d.DragClue,{ref:this.dragLogic.refDragElementClue})),this.showLicenseWatermark&&a.createElement(p.WatermarkOverlay,null)),D,this.props.pageable&&X))}calculateMedia(){this.checkMatchMediaColumnsDifferece()||this.forceUpdate()}selectionChange(r){if(this.props.onSelectionChange){const{event:h,dataItem:u,dataIndex:e,columnIndex:t}=r,{mode:s,cell:l}=d.getSelectionOptions(this.props.selectable),c={...this.getArguments(h.syntheticEvent),dataItem:u,startColIndex:t,endColIndex:t,startRowIndex:e,endRowIndex:e,dataItems:this.getLeafDataItems(),altKey:!1,ctrlKey:!1,shiftKey:!1,metaKey:!1,mode:s,cell:l,isDrag:!1,componentId:this._gridId,selectedField:this.props.selectedField||""};this.props.onSelectionChange.call(void 0,c)}}raiseDataEvent(r,h,u,e,t){const s=this.props.onDataStateChange;if(r){const l={...this.getArguments(e),...h,targetEvent:t};r.call(void 0,l)}else s&&s.call(void 0,{...this.getArguments(e),targetEvent:t||{},dataState:{...this.getDataState(),...u}})}columnReorder(r,h,u){const e=this._columns[r],t=e.depth,s=g=>{do g++;while(g<this._columns.length&&this._columns[g].depth>t);return g},l=this._columns.splice(r,s(r)-r);this._columns.splice(r<h?s(h-l.length):h,0,...l),this._columns.filter(g=>g.declarationIndex>=0).forEach((g,C)=>g.orderIndex=C),this._columnsMutations++;const c=this._columns[r].locked&&this._columns[h].locked;d.updateLeft(this._columnsMap,this._columns,c||this._shouldUpdateLeftRight),d.updateRight(this._columnsMap,this._columns,c||this._shouldUpdateLeftRight),this._resized&&(this._shouldUpdateLeftRight=!1,this._resized=!1);const n=this.columns;if(this.forceUpdate(),this.props.onColumnReorder){const g={target:this,columns:n,columnId:e.id,nativeEvent:u};this.props.onColumnReorder.call(void 0,g)}}groupReorder(r,h,u){if(this.props.group===void 0)return;const e=this.props.group.slice();e.splice(h,0,...e.splice(r,1)),this.groupChange(e,u)}columnToGroup(r,h,u){const e=this._columns[r].field;if(!e)return;const t=(this.props.group||[]).slice();t.splice(h,0,{field:e}),this.groupChange(t,u)}columnGroupChange(r,h){const u=this.dragLogic.getCurrentGroupsLength;this.columnToGroup(r,u,h)}resetTableWidth(){let r=0;if(!this.columnResize.colGroupMain)return;const h=this.columnResize.colGroupMain.children;for(let u=0;u<h.length;u++){const e=h[u].width;if(!e)return;r+=parseFloat(e.toString())}r=Math.round(r),this._header&&this._header.setWidth(r),this._footer&&this._footer.setWidth(r),this.tableElement&&(this.tableElement.style.width=r+"px")}initColumns(r,h){const u=d.tableKeyboardNavigationTools.getIdPrefix(this.navigationStateRef),e=this.filterHiddenColumns(r),t=this.readColumns(e,u,this._columnsMutations);this._columns=t,this._columns.length===0&&(this._columns=v.autoGenerateColumns(this.props.data,this.props.group,this.props.expandField,{prevId:0,idPrefix:u})),this.configureColumns(this._columns,h,u),this._columnsMap=this.mapColumns(this._columns,this._columnsMutations),this.columnResize.columns=this._columns,this.dragLogic.columns=this._columns}getDataState(){return{filter:this.props.filter,sort:this.props.sort,skip:this.props.skip,take:this.props.take!==void 0?this.props.take:this.props.pageSize,group:this.props.group}}getArguments(r){return{nativeEvent:r&&r.nativeEvent,syntheticEvent:r,target:this}}};T.displayName="KendoReactGrid",T.defaultProps={},T.propTypes={data:o.oneOfType([o.array,o.shape({data:o.array,total:o.number})]),sortable:o.oneOfType([o.bool,o.shape({mode:o.oneOf(["single","multiple"]),allowUnsort:o.bool})]),onSortChange:o.func,sort:o.array,filterable:o.bool,filter:o.any,onFilterChange:o.func,pageable:o.oneOfType([o.bool,o.shape({buttonCount:o.number,responsive:o.bool,info:o.bool,type:o.oneOf(["numeric","input"]),pageSizes:o.oneOfType([o.bool,o.arrayOf(o.oneOfType([o.string,o.number]))]),previousNext:o.bool})]),pageSize:o.number,onPageChange:o.func,total:o.number,skip:o.number,take:o.number,fixedScroll:o.bool,onExpandChange:o.func,expandField:o.string,selectedField:o.string,onSelectionChange:o.func,onHeaderSelectionChange:o.func,resizable:o.bool,reorderable:o.bool,group:o.any,groupable:o.oneOfType([o.bool,o.shape({enabled:o.bool,footer:o.oneOf(["always","visible","none"])})]),onGroupChange:o.func,onRowClick:o.func,onRowDoubleClick:o.func,onItemChange:o.func,editField:o.string,scrollable:o.oneOf(["none","scrollable","virtual"]),rowHeight:o.number,detailRowHeight:o.number,detail:o.any,style:o.object,onDataStateChange:o.func,onColumnResize:o.func,onColumnReorder:o.func,dataItemKey:o.string,navigatable:o.bool,size:o.oneOf(["small","medium"])},T.contextType=d.TableKeyboardNavigationContext;let K=T;ae.registerForLocalization(K);exports.Grid=K;
