/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const T=require("react"),c=require("prop-types"),v=require("@progress/kendo-date-math"),a=require("@progress/kendo-react-common"),S=require("@progress/kendo-react-intl"),b=require("../virtualization/Virtualization.js"),u=require("./models/TimePart.js"),x=require("./services/DayPeriodService.js"),y=require("./services/DOMService.js"),I=require("./services/HoursService.js"),M=require("./services/MinutesService.js"),H=require("./services/SecondsService.js"),d=require("../utils.js");function D(o){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const e in o)if(e!=="default"){const t=Object.getOwnPropertyDescriptor(o,e);Object.defineProperty(s,e,t.get?t:{enumerable:!0,get:()=>o[e]})}}return s.default=o,Object.freeze(s)}const r=D(T),E=2,g=.05,P=100,R=0,O=9,k={[a.Keys.end]:(o,s)=>o[o.length-1],[a.Keys.home]:(o,s)=>o[0],[a.Keys.up]:(o,s)=>o[s-1],[a.Keys.down]:(o,s)=>o[s+1]},m={[u.TIME_PART.dayperiod]:x.DayPeriodService,[u.TIME_PART.hour]:I.HoursService,[u.TIME_PART.minute]:M.MinutesService,[u.TIME_PART.second]:H.SecondsService},h=class h extends r.Component{constructor(s){super(s),this.intl=null,this._element=null,this.service=null,this.virtualization=null,this.topOffset=0,this.bottomOffset=0,this.itemHeight=0,this.listHeight=0,this.topThreshold=0,this.bottomThreshold=0,this.animateToIndex=!1,this.focus=e=>{Promise.resolve().then(()=>{this.element&&this.element.focus(e)})},this.itemOffset=e=>{if(!this.virtualization||!this.service)return-1;const t=this.service.selectedIndex(this.props.value),i=this.virtualization.activeIndex(),n=this.virtualization.itemOffset(i),l=Math.abs(Math.ceil(e)-n);if(t===i&&l<E)return n;const f=t>i;return f&&l>=this.bottomThreshold||!f&&l>this.topThreshold?this.virtualization.itemOffset(i+1):n},this.calculateHeights=()=>{this.dom.didCalculate&&(this.itemHeight=this.dom.itemHeight,this.listHeight=this.dom.timeListHeight,this.topOffset=(this.listHeight-this.itemHeight)/2,this.bottomOffset=this.listHeight-this.itemHeight,this.props.mobileMode&&(this.topOffset+=O,this.bottomOffset+=O*2),this.topThreshold=this.itemHeight*g,this.bottomThreshold=this.itemHeight*(1-g))},this.configureServices=({min:e,max:t,value:i}=this.props)=>{if(this.service){const[n,l]=this.service.limitRange(e||this.min,t||this.max,i||this.props.value);this.service.configure(this.serviceSettings({min:n,max:l}))}},this.serviceSettings=e=>{const t={boundRange:this.props.boundRange||h.defaultProps.boundRange,insertUndividedMax:!1,min:v.cloneDate(this.min),max:v.cloneDate(this.max),part:this.props.part,step:this.step},i=Object.assign({},t,e);return i.boundRange=i.part.type!=="hour"||this.props.boundRange||h.defaultProps.boundRange,i},this.handleScrollAction=({target:e,animationInProgress:t})=>{if(!(!this.virtualization||!this.service)&&e&&!t){this.animateToIndex=!1;const i=this.virtualization.itemIndex(this.itemOffset(e.scrollTop)),n=this.service.data(this.props.value)[i];this.handleChange(n)}},this.handleFocus=e=>{const{onFocus:t}=this.props;t&&t.call(void 0,e)},this.handleBlur=e=>{const{onBlur:t}=this.props;t&&t.call(void 0,e)},this.handleMouseOver=()=>{if(!this._element)return;const e=a.getActiveElement(document);document&&e!==this._element&&this.props.show&&this._element.focus({preventScroll:!0})},this.handleKeyDown=e=>{if(!this.service)return;const{keyCode:t}=e;(t===a.Keys.down||t===a.Keys.up||t===a.Keys.end||t===a.Keys.home)&&e.preventDefault();const n=(k[e.keyCode]||a.noop)(this.service.data(this.props.value),this.service.selectedIndex(this.props.value));n&&this.handleChange(n)},this.handleChange=d.debounce(e=>{if(!this.service)return;const t=this.service.apply(this.props.value,e.value);if(this.props.value.getTime()===t.getTime())return;const{onChange:i}=this.props;i&&i.call(void 0,t)},P),this.dom=new y.DOMService}get element(){return this._element}get animate(){return!!(this.props.smoothScroll&&this.animateToIndex)}get min(){return this.props.min||h.defaultProps.min}get max(){return this.props.max||h.defaultProps.max}get step(){return this.props.step!==void 0&&this.props.step!==0?Math.floor(this.props.step):h.defaultProps.step}componentDidMount(){Promise.resolve().then(()=>{this._element&&(this.dom.calculateHeights(this._element),this.forceUpdate())})}componentDidUpdate(){if(!this.virtualization||!this.service)return;const s=this.service.selectedIndex(this.props.value);this.virtualization[this.animate?"animateToIndex":"scrollToIndex"](s),this.animateToIndex=!0}render(){if(!this.props.part.type||!m[this.props.part.type])return;this.calculateHeights(),this.intl=S.provideIntlService(this),this.service=new m[this.props.part.type](this.intl),this.configureServices();const s=this.service.data(this.props.value),e="translateY("+this.topOffset+"px)",t=this.service.total(this.props.value),i=r.createElement(r.Fragment,null,r.createElement("ul",{style:{transform:e,msTransform:e},className:"k-reset"},s.map((n,l)=>r.createElement("li",{key:l,className:"k-item",onClick:()=>{this.handleChange(n)}},r.createElement("span",null,n.text)))),r.createElement("div",{className:"k-scrollable-placeholder"}));return r.createElement("div",{className:"k-time-list",id:String(this.props.id||""),tabIndex:this.props.disabled?-1:0,ref:n=>{this._element=n},onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseOver:this.handleMouseOver},this.dom.didCalculate?r.createElement(b.Virtualization,{bottomOffset:this.bottomOffset,children:i,className:"k-time-container",itemHeight:this.itemHeight,maxScrollDifference:this.listHeight,onScrollAction:this.handleScrollAction,ref:n=>{this.virtualization=n},role:"presentation",skip:R,tabIndex:-1,take:t,topOffset:this.topOffset,total:t}):r.createElement("div",{className:"k-time-container k-content k-scrollable"},i))}};h.propTypes={id:c.number,max:c.instanceOf(Date),min:c.instanceOf(Date),part:function(s,e,t){const i=s[e];if(!i||!m[i.type])throw new Error(`
                    Invalid prop '${e}' supplied to ${t}.
                    Supported part types are hour|minute|second|dayperiod.
                `);return null},step:function(s,e,t){const i=s[e];if(i!==void 0&&i<=0)throw new Error(`
                    Invalid prop '${e}' supplied to ${t}.
                    ${e} cannot be less than 1.
                `);return null},value:c.instanceOf(Date),smoothScroll:c.bool,show:c.bool},h.defaultProps={boundRange:!1,max:d.MAX_TIME,min:d.MIDNIGHT_DATE,step:1,smoothScroll:!0};let p=h;S.registerForIntl(p);exports.TimeList=p;
