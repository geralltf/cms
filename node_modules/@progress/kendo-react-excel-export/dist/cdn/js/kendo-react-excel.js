/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("react"),require("prop-types"),require("@progress/kendo-file-saver"),require("@progress/kendo-ooxml"),require("react-dom/server"),require("@progress/kendo-react-common")):"function"==typeof define&&define.amd?define(["exports","react","prop-types","@progress/kendo-file-saver","@progress/kendo-ooxml","react-dom/server","@progress/kendo-react-common"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).KendoReactExcel={},e.React,e.PropTypes,e.KendoFileSaver,e.KendoOoxml,e.ReactDOMServer,e.KendoReactCommon)}(this,(function(e,o,t,r,l,s,i){"use strict";function n(e){var o=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}})),o.default=e,Object.freeze(o)}var p=n(o),a=n(l),d=n(s);const c=(e,o,t)=>r=>{t(o,r);const l=d.renderToStaticMarkup(p.createElement(e,{...o})),s=Number(l);return isNaN(s)?l:s},h=(e,o)=>{e.$implicit=e.group=o,e.field=o.field,e.value=o.value,e.aggregates=o.aggregates},u=(e,o)=>{e.group=o.group,e.$implicit=e.aggregates=o},g=(e,o)=>{};class m{constructor(e,o){this.columns=null,this.title=e.title,this.field=e.field,this.hidden=e.hidden,this.locked=e.locked,this.width=e.width,this.headerCellOptions=e.headerCellOptions,this.cellOptions=e.cellOptions,this.groupHeaderCellOptions=e.groupHeaderCellOptions,this.groupFooterCellOptions=e.groupFooterCellOptions,this.footerCellOptions=e.footerCellOptions,e.footer&&(this.footerTemplate=c(e.footer,{$implicit:e,column:e,columnIndex:o},g)),e.groupFooter&&(this.groupFooterTemplate=c(e.groupFooter,{column:e,field:e.field},u)),e.groupHeader&&(this.groupHeaderTemplate=c(e.groupHeader,{},h))}}const f=e=>Math.max(...e.map((e=>e.level)))+1,y=e=>{const o=(e=>{const o=[];let t=0;const r=(e,o,l)=>{e.forEach((e=>{if(e.level===l){const s=new m(e,t);if(o.push(s),e.children&&e.children.length>1){const o=s.columns=[];r(e.children,o,l+1)}else t++}}))};return r(e,o,0),o})(e.columns),t=new l.ExcelExporter({columns:o,data:e.data,filterable:e.filterable,groups:e.group,paddingCellOptions:e.paddingCellOptions,headerPaddingCellOptions:e.headerPaddingCellOptions,hierarchy:e.hierarchy?{depth:f(e.data),itemLevel:e=>e.level}:null,collapsible:e.collapsible}).workbook();return t.creator=e.creator,t.date=e.date,t.rtl="rtl"===e.dir,t},x=e=>new l.Workbook(e).toDataURL(),O=e=>e&&e.sheets,b={name:"@progress/kendo-react-excel-export",productName:"KendoReact",productCodes:["KENDOUIREACT","KENDOUICOMPLETE"],publishDate:0,version:"",licensingDocsUrl:"https://www.telerik.com/kendo-react-ui/components/my-license/"},C=class extends p.Component{constructor(e){super(e),this.saveFile=e=>{r.saveAs(e,this.props.fileName,{forceProxy:this.props.forceProxy,proxyURL:this.props.proxyURL})},this.extractColumns=(e,o=0)=>Array.isArray(e)?e.map((e=>this.extractChild(e,o))):[e,this.extractChild(e,o)],this.extractChild=(e,o=0)=>p.isValidElement(e)?{...e.props,width:e.props.width&&parseInt(`${e.props.width}`,10),level:o,children:e.props.children&&this.extractColumns(e.props.children,o+1)}:{...e,level:o,children:e.children&&this.extractColumns(e.children,o+1)},this.getExportData=e=>{let o;return o=e?Array.isArray(e)?{data:e}:e:{data:this.props.data,group:this.props.group},o},i.validatePackage(b),this.save=this.save.bind(this),this.toDataURL=this.toDataURL.bind(this),this.workbookOptions=this.workbookOptions.bind(this)}save(e,o){this.toDataURL(e,o).then(((...e)=>{this.props.onExportComplete&&this.props.onExportComplete.call(void 0,{target:this}),this.saveFile(...e)}))}toDataURL(e,o){const t=O(e)?e:this.workbookOptions(e,o);return x(t)}workbookOptions(e,o){const t=this.getExportData(e),r=this.props.children,l=r&&r.type&&"KendoReactGrid"===r.type.displayName&&r.props&&p.Children.toArray(r.props.children),s=this.extractColumns(l||o||this.props.columns||p.Children.toArray(r));return y({columns:s,data:t.data,group:t.group,filterable:this.props.filterable,creator:this.props.creator,date:this.props.date,dir:this.props.dir,hierarchy:this.props.hierarchy,paddingCellOptions:this.props.paddingCellOptions,headerPaddingCellOptions:this.props.headerPaddingCellOptions,collapsible:this.props.collapsible})}render(){return this.props.children||null}};C.propTypes={children:t.any,columns:t.arrayOf(t.any),creator:t.string,data:t.any,date:t.any,filterable:t.bool,fileName:t.string,forceProxy:t.bool,group:t.any,headerPaddingCellOptions:t.any,paddingCellOptions:t.any,proxyURL:t.string,dir:t.string,hierarchy:t.bool,collapsible:t.bool},C.defaultProps={fileName:"Export.xlsx",forceProxy:!1,collapsible:!1};let k=C;const E=e=>null;E.propTypes={cellOptions:t.any,field:t.string,footerCellOptions:t.any,footer:t.oneOfType([t.func,t.element]),groupFooterCellOptions:t.any,groupFooter:t.oneOfType([t.func,t.element]),groupHeaderCellOptions:t.any,groupHeader:t.oneOfType([t.func,t.element]),headerCellOptions:t.any,hidden:t.bool,level:t.number,locked:t.bool,title:t.string,width:t.number};const v=e=>null;v.propTypes={children:t.oneOfType([t.arrayOf(t.element),t.element]),headerCellOptions:t.any,hidden:t.bool,level:t.number,locked:t.bool,title:t.string,width:t.number};let w=class extends p.PureComponent{};class P extends p.PureComponent{}class R extends p.PureComponent{}e.KendoOoxml=a,e.ExcelExport=k,e.ExcelExportColumn=E,e.ExcelExportColumnGroup=v,e.ExcelExportFooter=w,e.ExcelExportGroupFooter=P,e.ExcelExportGroupHeader=R,e.isWorkbookOptions=O,e.toDataURL=x,e.workbookOptions=y}));
