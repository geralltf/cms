/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("react"),e=require("prop-types"),u=require("@progress/kendo-file-saver"),p=require("./ooxml/workbook.js"),y=require("@progress/kendo-react-common"),b=require("./package-metadata.js");function g(i){const o=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(i){for(const t in i)if(t!=="default"){const r=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(o,t,r.get?r:{enumerable:!0,get:()=>i[t]})}}return o.default=i,Object.freeze(o)}const a=g(d),n=class n extends a.Component{constructor(o){super(o),this.saveFile=t=>{u.saveAs(t,this.props.fileName,{forceProxy:this.props.forceProxy,proxyURL:this.props.proxyURL})},this.extractColumns=(t,r=0)=>Array.isArray(t)?t.map(s=>this.extractChild(s,r)):[t,this.extractChild(t,r)],this.extractChild=(t,r=0)=>a.isValidElement(t)?{...t.props,width:t.props.width&&parseInt(`${t.props.width}`,10),level:r,children:t.props.children&&this.extractColumns(t.props.children,r+1)}:{...t,level:r,children:t.children&&this.extractColumns(t.children,r+1)},this.getExportData=t=>{let r;return t?Array.isArray(t)?r={data:t}:r=t:r={data:this.props.data,group:this.props.group},r},y.validatePackage(b.packageMetadata),this.save=this.save.bind(this),this.toDataURL=this.toDataURL.bind(this),this.workbookOptions=this.workbookOptions.bind(this)}save(o,t){this.toDataURL(o,t).then((...r)=>{this.props.onExportComplete&&this.props.onExportComplete.call(void 0,{target:this}),this.saveFile(...r)})}toDataURL(o,t){const r=p.isWorkbookOptions(o)?o:this.workbookOptions(o,t);return p.toDataURL(r)}workbookOptions(o,t){const r=this.getExportData(o),s=this.props.children,c=s&&s.type&&s.type.displayName==="KendoReactGrid"&&s.props&&a.Children.toArray(s.props.children),h=this.extractColumns(c||t||this.props.columns||a.Children.toArray(s));return p.workbookOptions({columns:h,data:r.data,group:r.group,filterable:this.props.filterable,creator:this.props.creator,date:this.props.date,dir:this.props.dir,hierarchy:this.props.hierarchy,paddingCellOptions:this.props.paddingCellOptions,headerPaddingCellOptions:this.props.headerPaddingCellOptions,collapsible:this.props.collapsible})}render(){return this.props.children||null}};n.propTypes={children:e.any,columns:e.arrayOf(e.any),creator:e.string,data:e.any,date:e.any,filterable:e.bool,fileName:e.string,forceProxy:e.bool,group:e.any,headerPaddingCellOptions:e.any,paddingCellOptions:e.any,proxyURL:e.string,dir:e.string,hierarchy:e.bool,collapsible:e.bool},n.defaultProps={fileName:"Export.xlsx",forceProxy:!1,collapsible:!1};let l=n;exports.ExcelExport=l;
